
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "beginner/basics/transforms_tutorial.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_beginner_basics_transforms_tutorial.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_basics_transforms_tutorial.py:


`Learn the Basics <intro.html>`_ ||
`Quickstart <quickstart_tutorial.html>`_ ||
`Tensors <tensorqs_tutorial.html>`_ ||
`Datasets & DataLoaders <data_tutorial.html>`_ ||
**Transforms** ||
`Build Model <buildmodel_tutorial.html>`_ ||
`Autograd <autogradqs_tutorial.html>`_ ||
`Optimization <optimization_tutorial.html>`_ ||
`Save & Load Model <saveloadrun_tutorial.html>`_

Transforms
===================

Data does not always come in its final processed form that is required for
training machine learning algorithms. We use **transforms** to perform some
manipulation of the data and make it suitable for training.

All TorchVision datasets have two parameters -``transform`` to modify the features and
``target_transform`` to modify the labels - that accept callables containing the transformation logic.
The `torchvision.transforms <https://pytorch.org/vision/stable/transforms.html>`_ module offers
several commonly-used transforms out of the box.

The FashionMNIST features are in PIL Image format, and the labels are integers.
For training, we need the features as normalized tensors, and the labels as one-hot encoded tensors.
To make these transformations, we use ``ToTensor`` and ``Lambda``.

.. GENERATED FROM PYTHON SOURCE LINES 28-41

.. code-block:: default


    import torch
    from torchvision import datasets
    from torchvision.transforms import ToTensor, Lambda

    ds = datasets.FashionMNIST(
        root="data",
        train=True,
        download=True,
        transform=ToTensor(),
        target_transform=Lambda(lambda y: torch.zeros(10, dtype=torch.float).scatter_(0, torch.tensor(y), value=1))
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz
    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz to data/FashionMNIST/raw/train-images-idx3-ubyte.gz

      0%|          | 0/26421880 [00:00<?, ?it/s]
      0%|          | 32768/26421880 [00:00<01:25, 307445.62it/s]
      0%|          | 65536/26421880 [00:00<01:27, 302321.01it/s]
      0%|          | 131072/26421880 [00:00<01:00, 437749.98it/s]
      1%|          | 229376/26421880 [00:00<00:42, 619512.56it/s]
      2%|1         | 458752/26421880 [00:00<00:22, 1151665.13it/s]
      2%|2         | 622592/26421880 [00:00<00:20, 1268044.63it/s]
      3%|2         | 786432/26421880 [00:00<00:19, 1342059.86it/s]
      4%|3         | 983040/26421880 [00:00<00:17, 1484945.28it/s]
      4%|4         | 1179648/26421880 [00:00<00:15, 1580340.44it/s]
      5%|5         | 1343488/26421880 [00:01<00:16, 1555692.48it/s]
      6%|5         | 1540096/26421880 [00:01<00:15, 1627343.64it/s]
      7%|6         | 1736704/26421880 [00:01<00:14, 1677545.28it/s]
      7%|7         | 1966080/26421880 [00:01<00:13, 1799304.89it/s]
      8%|8         | 2162688/26421880 [00:01<00:13, 1798059.43it/s]
      9%|8         | 2359296/26421880 [00:01<00:13, 1799194.21it/s]
     10%|9         | 2588672/26421880 [00:01<00:12, 1882393.50it/s]
     11%|#         | 2785280/26421880 [00:01<00:12, 1860132.92it/s]
     11%|#1        | 3014656/26421880 [00:01<00:12, 1926853.82it/s]
     12%|#2        | 3244032/26421880 [00:02<00:11, 1973299.77it/s]
     13%|#3        | 3473408/26421880 [00:02<00:11, 2005862.00it/s]
     14%|#4        | 3702784/26421880 [00:02<00:11, 2028640.34it/s]
     15%|#4        | 3932160/26421880 [00:02<00:10, 2047772.30it/s]
     16%|#5        | 4161536/26421880 [00:02<00:10, 2061555.52it/s]
     17%|#6        | 4390912/26421880 [00:02<00:10, 2071849.05it/s]
     17%|#7        | 4620288/26421880 [00:02<00:10, 2082033.23it/s]
     18%|#8        | 4849664/26421880 [00:02<00:10, 2088236.12it/s]
     19%|#9        | 5079040/26421880 [00:02<00:10, 2090353.66it/s]
     20%|##        | 5308416/26421880 [00:03<00:10, 2091094.05it/s]
     21%|##1       | 5570560/26421880 [00:03<00:09, 2175902.69it/s]
     22%|##1       | 5799936/26421880 [00:03<00:09, 2152206.26it/s]
     23%|##2       | 6029312/26421880 [00:03<00:09, 2136002.79it/s]
     24%|##3       | 6291456/26421880 [00:03<00:09, 2206275.69it/s]
     25%|##4       | 6520832/26421880 [00:03<00:09, 2177975.06it/s]
     26%|##5       | 6782976/26421880 [00:03<00:08, 2235483.24it/s]
     27%|##6       | 7012352/26421880 [00:03<00:08, 2198819.49it/s]
     28%|##7       | 7274496/26421880 [00:03<00:08, 2249891.65it/s]
     28%|##8       | 7503872/26421880 [00:04<00:08, 2208239.86it/s]
     29%|##9       | 7766016/26421880 [00:04<00:08, 2257717.53it/s]
     30%|###       | 8028160/26421880 [00:04<00:08, 2292737.03it/s]
     31%|###1      | 8257536/26421880 [00:04<00:08, 2237750.70it/s]
     32%|###2      | 8519680/26421880 [00:04<00:07, 2278410.27it/s]
     33%|###3      | 8749056/26421880 [00:04<00:07, 2228557.49it/s]
     34%|###4      | 9011200/26421880 [00:04<00:07, 2272542.67it/s]
     35%|###4      | 9240576/26421880 [00:04<00:07, 2226228.28it/s]
     36%|###5      | 9502720/26421880 [00:04<00:07, 2266818.99it/s]
     37%|###6      | 9764864/26421880 [00:05<00:07, 2299737.45it/s]
     38%|###7      | 10027008/26421880 [00:05<00:07, 2322683.24it/s]
     39%|###8      | 10289152/26421880 [00:05<00:06, 2338135.68it/s]
     40%|###9      | 10551296/26421880 [00:05<00:06, 2349715.49it/s]
     41%|####      | 10813440/26421880 [00:05<00:06, 2357543.89it/s]
     42%|####1     | 11075584/26421880 [00:05<00:06, 2366529.53it/s]
     43%|####2     | 11337728/26421880 [00:05<00:06, 2369653.51it/s]
     44%|####3     | 11599872/26421880 [00:05<00:06, 2372517.67it/s]
     45%|####4     | 11862016/26421880 [00:05<00:06, 2374627.31it/s]
     46%|####5     | 12124160/26421880 [00:06<00:06, 2374779.74it/s]
     47%|####6     | 12386304/26421880 [00:06<00:05, 2374880.17it/s]
     48%|####7     | 12648448/26421880 [00:06<00:05, 2375939.55it/s]
     49%|####8     | 12910592/26421880 [00:06<00:05, 2376257.33it/s]
     50%|####9     | 13172736/26421880 [00:06<00:05, 2345986.48it/s]
     51%|#####     | 13434880/26421880 [00:06<00:05, 2354939.10it/s]
     52%|#####1    | 13697024/26421880 [00:06<00:05, 2362262.42it/s]
     53%|#####2    | 13959168/26421880 [00:06<00:05, 2367052.86it/s]
     54%|#####3    | 14221312/26421880 [00:06<00:05, 2370665.88it/s]
     55%|#####4    | 14483456/26421880 [00:07<00:06, 1892134.80it/s]
     56%|#####5    | 14745600/26421880 [00:07<00:05, 2014547.25it/s]
     57%|#####6    | 15007744/26421880 [00:07<00:05, 2110526.00it/s]
     58%|#####7    | 15237120/26421880 [00:07<00:05, 2111144.89it/s]
     59%|#####8    | 15499264/26421880 [00:07<00:04, 2187561.06it/s]
     60%|#####9    | 15761408/26421880 [00:07<00:04, 2242362.88it/s]
     61%|######    | 15990784/26421880 [00:07<00:04, 2206725.70it/s]
     62%|######1   | 16252928/26421880 [00:07<00:04, 2256347.59it/s]
     63%|######2   | 16515072/26421880 [00:08<00:04, 2292382.31it/s]
     63%|######3   | 16777216/26421880 [00:08<00:04, 2317548.26it/s]
     64%|######4   | 17039360/26421880 [00:08<00:04, 2339257.48it/s]
     65%|######5   | 17301504/26421880 [00:08<00:03, 2349233.53it/s]
     66%|######6   | 17563648/26421880 [00:08<00:03, 2361411.61it/s]
     67%|######7   | 17825792/26421880 [00:08<00:03, 2370359.03it/s]
     68%|######8   | 18087936/26421880 [00:08<00:03, 2376362.24it/s]
     69%|######9   | 18350080/26421880 [00:08<00:03, 2380469.84it/s]
     70%|#######   | 18612224/26421880 [00:08<00:03, 2389523.97it/s]
     71%|#######1  | 18874368/26421880 [00:08<00:03, 2390524.56it/s]
     72%|#######2  | 19136512/26421880 [00:09<00:03, 2395231.52it/s]
     73%|#######3  | 19398656/26421880 [00:09<00:02, 2396061.70it/s]
     74%|#######4  | 19660800/26421880 [00:09<00:02, 2394204.46it/s]
     76%|#######5  | 19955712/26421880 [00:09<00:02, 2477915.65it/s]
     77%|#######6  | 20217856/26421880 [00:09<00:02, 2453383.42it/s]
     78%|#######7  | 20512768/26421880 [00:09<00:02, 2518992.54it/s]
     79%|#######8  | 20774912/26421880 [00:09<00:02, 2483611.07it/s]
     80%|#######9  | 21069824/26421880 [00:09<00:02, 2544187.30it/s]
     81%|########  | 21364736/26421880 [00:09<00:01, 2588061.48it/s]
     82%|########1 | 21659648/26421880 [00:10<00:01, 2612583.97it/s]
     83%|########3 | 21954560/26421880 [00:10<00:01, 2640744.19it/s]
     84%|########4 | 22249472/26421880 [00:10<00:01, 2654828.37it/s]
     85%|########5 | 22577152/26421880 [00:10<00:01, 2742867.08it/s]
     87%|########6 | 22872064/26421880 [00:10<00:01, 2733058.08it/s]
     88%|########7 | 23199744/26421880 [00:10<00:01, 2803104.24it/s]
     89%|########8 | 23494656/26421880 [00:10<00:01, 2778485.36it/s]
     90%|######### | 23822336/26421880 [00:10<00:00, 2836814.41it/s]
     91%|#########1| 24150016/26421880 [00:10<00:00, 2885734.89it/s]
     93%|#########2| 24477696/26421880 [00:11<00:00, 2916045.45it/s]
     94%|#########4| 24838144/26421880 [00:11<00:00, 3019114.11it/s]
     95%|#########5| 25165824/26421880 [00:11<00:00, 3017236.86it/s]
     97%|#########6| 25526272/26421880 [00:11<00:00, 3091454.28it/s]
     98%|#########7| 25886720/26421880 [00:11<00:00, 3146265.00it/s]
     99%|#########9| 26247168/26421880 [00:11<00:00, 3188591.38it/s]
    100%|##########| 26421880/26421880 [00:11<00:00, 2271831.27it/s]
    Extracting data/FashionMNIST/raw/train-images-idx3-ubyte.gz to data/FashionMNIST/raw

    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz
    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw/train-labels-idx1-ubyte.gz

      0%|          | 0/29515 [00:00<?, ?it/s]
    100%|##########| 29515/29515 [00:00<00:00, 276965.25it/s]
    100%|##########| 29515/29515 [00:00<00:00, 275632.63it/s]
    Extracting data/FashionMNIST/raw/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw

    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz
    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz

      0%|          | 0/4422102 [00:00<?, ?it/s]
      1%|          | 32768/4422102 [00:00<00:14, 301719.47it/s]
      1%|1         | 65536/4422102 [00:00<00:14, 300667.66it/s]
      3%|2         | 131072/4422102 [00:00<00:09, 437414.62it/s]
      5%|5         | 229376/4422102 [00:00<00:06, 620531.59it/s]
     11%|#1        | 491520/4422102 [00:00<00:03, 1262120.20it/s]
     21%|##1       | 950272/4422102 [00:00<00:01, 2261161.52it/s]
     44%|####3     | 1933312/4422102 [00:00<00:00, 4461780.45it/s]
     87%|########6 | 3833856/4422102 [00:00<00:00, 8580841.26it/s]
    100%|##########| 4422102/4422102 [00:00<00:00, 5047237.85it/s]
    Extracting data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw

    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz
    Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz

      0%|          | 0/5148 [00:00<?, ?it/s]
    100%|##########| 5148/5148 [00:00<00:00, 12430786.98it/s]
    Extracting data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw





.. GENERATED FROM PYTHON SOURCE LINES 42-49

ToTensor()
-------------------------------

`ToTensor <https://pytorch.org/vision/stable/transforms.html#torchvision.transforms.ToTensor>`_
converts a PIL image or NumPy ``ndarray`` into a ``FloatTensor``. and scales
the image's pixel intensity values in the range [0., 1.]


.. GENERATED FROM PYTHON SOURCE LINES 51-59

Lambda Transforms
-------------------------------

Lambda transforms apply any user-defined lambda function. Here, we define a function
to turn the integer into a one-hot encoded tensor.
It first creates a zero tensor of size 10 (the number of labels in our dataset) and calls
`scatter_ <https://pytorch.org/docs/stable/generated/torch.Tensor.scatter_.html>`_ which assigns a
``value=1`` on the index as given by the label ``y``.

.. GENERATED FROM PYTHON SOURCE LINES 59-63

.. code-block:: default


    target_transform = Lambda(lambda y: torch.zeros(
        10, dtype=torch.float).scatter_(dim=0, index=torch.tensor(y), value=1))








.. GENERATED FROM PYTHON SOURCE LINES 64-66

--------------


.. GENERATED FROM PYTHON SOURCE LINES 68-71

Further Reading
~~~~~~~~~~~~~~~~~
- `torchvision.transforms API <https://pytorch.org/vision/stable/transforms.html>`_


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  15.180 seconds)


.. _sphx_glr_download_beginner_basics_transforms_tutorial.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: transforms_tutorial.py <transforms_tutorial.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: transforms_tutorial.ipynb <transforms_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
